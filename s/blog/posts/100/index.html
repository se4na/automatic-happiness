<!DOCTYPE html>

<html lang='ja'>
<head>
<link href='https://michilu.com/blog/posts/100/' rel='canonical'>
<link href='https://michilu.com/blog/posts/100/' rel='amphtml'>
<meta content='noindex' name='robots'>
<meta charset='utf-8'>
<meta content='width=device-width,minimum-scale=1,initial-scale=1' name='viewport'>
<meta content='telephone=no' name='format-detection'>
<script async custom-element='amp-form' src='https://cdn.ampproject.org/v0/amp-form-0.1.js'></script>
<script async custom-element='amp-analytics' src='https://cdn.ampproject.org/v0/amp-analytics-0.1.js'></script>
<script async custom-element='amp-list' src='https://cdn.ampproject.org/v0/amp-list-0.1.js'></script>
<script async custom-template='amp-mustache' src='https://cdn.ampproject.org/v0/amp-mustache-0.2.js'></script>
<script async custom-element='amp-fit-text' src='https://cdn.ampproject.org/v0/amp-fit-text-0.1.js'></script>
<script async custom-element='amp-carousel' src='https://cdn.ampproject.org/v0/amp-carousel-0.1.js'></script>
<script async src='https://cdn.ampproject.org/v0.js'></script>
<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<title>[Django]: Django和訳ドキュメント sync to r5754&middot;ツキヨミチル</title>
<style amp-custom>
body,hr{position:relative}figure,p{padding-bottom:2.4rem}*{border:0;font:inherit;margin:0;padding:0;text-rendering:geometricPrecision}code,kbd,pre,samp{border-radius:2px;overflow-y:hidden;overflow-x:auto}html{box-sizing:border-box;font-size:62.5%;height:100%}@media screen and (min-width:960px){html{font-size:78.125%}}body{box-sizing:border-box;color:#3c3c3d;font-size:1.6rem;line-height:2.4rem;min-height:100%}h1,h2,h3,h4,h5,h6{font-weight:500}h1,h2,h3{line-height:4.8rem;padding:.8rem 0 1.6rem}form,h4,h5,h6{padding:2.4rem 0}h1{font-size:3.6rem}h2{font-size:3.2rem}h3{font-size:2.8rem}h4{font-size:2rem}h5{font-size:1.8rem}h6{font-size:1.6rem}.fs-small,code,kbd,pre,samp,small,sub,sup{font-size:1.2rem}code,kbd,pre,samp{background-color:#efeff0;color:#e528b0;font-family:Consolas,Monaco,"Courier New",monospace;line-height:1}code,kbd,samp{padding:.4rem .4rem .2rem}pre{line-height:2.4rem;padding:1.2rem 1rem;margin:0 0 2.4rem}pre code,pre kbd,pre samp{background-color:transparent;border:none;border-radius:0;padding:0}a:link{color:#4076D4}a:visited{color:#9140D4}a:focus,a:hover{color:#2e68cc}a:active{color:#D44076}img,video{max-width:100%;display:table}hr{height:4.8rem;margin-bottom:2.4rem}hr:before{background-color:#cdcdce;content:'';height:1px;position:absolute;top:50%;width:100%}ol,ul{margin-left:2rem;padding:0 0 2.4rem}ol{list-style-type:decimal}blockquote p:last-child,ol ol,ul ul{padding-bottom:0}ul{list-style-type:disc}cite,dt,em,i,q>q{font-style:italic}dd{padding-left:2rem}blockquote{margin:0 0 2.4rem 1.2rem;border-left:.3rem solid #cdcdce;padding:2.4rem 1.2rem}figure{margin:0 auto}figure img{display:table;margin:0 auto}small,sub,sup{line-height:1}caption,figcaption{font-size:1.2rem;font-style:italic;text-align:center}.ta-left,table th{text-align:left}b,strong,var{font-weight:700}q:after,q:before{content:"'"}.checkbox:before,.checkbox__label:after,.radio:before,.radio__label:after{content:'';margin-top:-10px;position:absolute}abbr,dfn{border-bottom:.1rem dotted #5a5a5b;cursor:default}table{border-radius:2px;border-collapse:separate;border-spacing:0;margin-bottom:2.4rem;width:100%}table th{font-weight:500}table td,table th{padding:0 .6rem}label{color:#7d7d7e}button,input,label,select,textarea{display:block;resize:none;-webkit-appearance:none;-moz-appearance:none}input:-webkit-autofill,select:-webkit-autofill,textarea:-webkit-autofill{color:#3c3c3d;-webkit-text-fill-color:#3c3c3d;-webkit-box-shadow:0 0 0 1000px #fff inset}.checkbox [disabled],.checkbox [disabled]+*,.disabled,.radio [disabled],.radio [disabled]+*,.select [disabled],.select [disabled]+*,.textfield [disabled],.textfield [disabled]+*,[type=button][disabled],[type=submit][disabled],button[disabled]{cursor:default;opacity:.5;pointer-events:none}.smooth{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.f-none{float:none}.f-left{float:left}.f-right{float:right}.clearfix{clear:both;overflow:hidden}.ta-center{text-align:center}.ta-right{text-align:right}.fs-base{font-size:1.6rem}.fs-large{font-size:2rem}.fw-light{font-weight:300}.fw-normal{font-weight:400}.fw-semibold{font-weight:600}.fw-bold{font-weight:700}.btn,[type=button],[type=submit],button{background-color:#E83FB8;border:none;border-radius:.2rem;box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;height:4.8rem;line-height:4.8rem;max-width:100%;-webkit-transition-property:background-color;transition-property:background-color;-webkit-transition-duration:.2s;transition-duration:.2s;margin:0 auto;padding:0 3rem;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:auto}.btn:link,.btn:visited,[type=button]:link,[type=button]:visited,[type=submit]:link,[type=submit]:visited,button:link,button:visited{color:#fff;text-decoration:none}.btn:focus,.btn:hover,[type=button]:focus,[type=button]:hover,[type=submit]:focus,[type=submit]:hover,button:focus,button:hover{background-color:#e528b0;color:#fff}.btn:focus,[type=button]:focus,[type=submit]:focus,button:focus{outline:#7d7d7e dotted .1rem}.btn:active,[type=button]:active,[type=submit]:active,button:active{background-color:#E83FB8}.btn--secondary{background-color:#efeff0;color:#3c3c3d}.btn--secondary:link,.btn--secondary:visited{color:#3c3c3d}.btn--secondary:focus,.btn--secondary:hover{background-color:#dededf;color:#3c3c3d}.btn--link,.btn--link:active{background-color:transparent}.btn--secondary:active{color:#7d7d7e}.btn--link,.btn--link:link{color:#4076D4}.btn--link{text-decoration:underline}.btn--link:visited{color:#9140D4}.btn--link:focus,.btn--link:hover{color:#2e68cc;background-color:transparent}.btn--link:active{color:#D44076}.checkbox,.radio{cursor:pointer;display:inline-block;margin-bottom:2.4rem;padding:0 1rem 0 2.25rem;position:relative}.checkbox:before,.radio:before{background-color:#fff;border:2px solid #7d7d7e;height:16px;left:0;top:50%;width:16px}.checkbox input[type=checkbox],.radio input[type=radio]{opacity:0;position:absolute;z-index:-1}.checkbox__label,.radio__label{color:#7d7d7e;font-size:1.2rem;line-height:1}.checkbox__label:after,.radio__label:after{border:1px solid transparent;height:18px;left:0;top:50%;width:18px}.checkbox input[type=checkbox]:focus+.checkbox__label:after,.radio input[type=radio]:focus+.radio__label:after{border-color:#E83FB8;box-shadow:0 1px 2px 1px #dededf inset}.select,.textfield{background-color:#fff;display:block;margin-top:-2px;margin-bottom:2.4rem;position:relative}.select__label,.textfield__label{background-color:#fff;font-size:1.2rem;position:absolute;left:1px;line-height:1;padding:.5rem;right:1px;top:1px}.select select,.textfield input,.textfield textarea{background-color:transparent;border:1px solid #7d7d7e;border-radius:2px;box-sizing:border-box;padding:1.8rem .5rem .6rem;position:relative;width:100%}.select select:focus,.textfield :focus{border-color:#E83FB8;box-shadow:0 1px 2px 0 #dededf inset;outline:0}.radio:before,.radio__label:after{border-radius:20px}.radio input[type=radio]:checked+.radio__label:before{background-color:#e528b0;border-radius:20px;content:'';height:10px;left:5px;margin-top:-5px;position:absolute;top:50%;width:10px}.checkbox:before,.checkbox__label:after{border-radius:2px}.checkbox input[type=checkbox]:checked+.checkbox__label:after{color:#e528b0;content:'\2714';font-size:14px;line-height:18px;text-align:center}.select:after{content:'';border-left:.6rem solid transparent;border-right:.6rem solid transparent;border-top:.6rem solid #7d7d7e;height:0;margin-top:-.5rem;position:absolute;right:1rem;bottom:1.3rem;width:0}.select select{z-index:100}.select option[disabled]{background-color:#efeff0;color:#5a5a5b}.grid{display:-ms-flexbox;display:-webkit-box;display:flex}.grid>*{-ms-flex:1;flex:1;-webkit-box-flex:4;-ms-flex-positive:4;flex-grow:4;padding-left:1rem;padding-right:1rem}.grid>:first-child:not(:last-child){margin-left:-1rem}.grid>:last-child:not(:first-child){margin-right:-1rem}.grid>.column--light{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2}.grid>.column--heavy{-webkit-box-flex:8;-ms-flex-positive:8;flex-grow:8}@media (max-width:599px){.grid--medium{display:block}.grid--medium>*{padding-left:0;padding-right:0}.grid--medium>:first-child{margin-left:0}.grid--medium>:last-child{margin-right:0}}@media (max-width:959px){.grid--large{display:block}.grid--large>*{padding-left:0;padding-right:0}.grid--large>:first-child{margin-left:0}.grid--large>:last-child{margin-right:0}}.wrapper{margin:0 auto;max-width:960px;padding:4.8rem 0}.wrapper--large{max-width:1200px;padding:7.2rem 0}.wrapper--small{max-width:640px;padding:2.4rem 0}
.btn--primary{background-color:#3FE8B8}.btn--primary:focus,.btn--primary:hover{background-color:#28e5b0}.btn--primary:active{color:#3FE8B8}.btn--success{background-color:#3FE8B8}.btn--success:focus,.btn--success:hover{background-color:#28e5b0}.btn--success:active{color:#3FE8B8}.btn--info{background-color:#3FB8E8}.btn--info:focus,.btn--info:hover{background-color:#28b0e5}.btn--info:active{color:#3FB8E8}.btn--warning{background-color:#E8B83F}.btn--warning:focus,.btn--warning:hover{background-color:#e5b028}.btn--warning:active{color:#E8B83F}.btn--danger{background-color:#E8633F}.btn--danger:focus,.btn--danger:hover{background-color:#e55028}.btn--danger:active{color:#E8633F}@media only screen and (orientation: portrait){.gsc-results-wrapper-overlay{left:3%;top:2%;width:94%;height:96%;padding:30px 15px 15px}}#navbar-top{position:fixed}#navbar-bottom{max-width:800px;bottom:0}#navbar-top,#navbar-bottom{width:100%;z-index:2;transition-delay:0s,0s;transition-duration:.2s,.2s;transition-timing-function:ease,ease}@media screen and (orientation: landscape){#navbar-top{width:inherit;left:inherit;right:0}}#share-icon{width:100%;margin:0;background:#fff;box-shadow:0 0 1px #767676}#share-icon>a{padding-top:0;padding-bottom:10px;color:#999;text-decoration:none}#share-icon>a:first-child{box-shadow:inset -1.5px 0 0px #f3f3f3;border-radius:0}@media screen and (orientation: landscape){#share-icon>a:first-child{min-width:calc(100vw/6)}}#share-icon>a [class^="icon-"],#share-icon>a [class*=" icon-"]{background-color:#fff}#share-icon>a.share-facebook:hover,#share-icon>a.share-facebook:active,#share-icon>a.share-facebook:focus{color:#3b5998}#share-icon>a.share-twitter:hover,#share-icon>a.share-twitter:active,#share-icon>a.share-twitter:focus{color:#68aade}#share-icon>a.share-line:hover,#share-icon>a.share-line:active,#share-icon>a.share-line:focus{color:#00cf00}#share-icon>a.share-hatena:hover,#share-icon>a.share-hatena:active,#share-icon>a.share-hatena:focus{color:#008fde}#share-icon>a.share-pinterest:hover,#share-icon>a.share-pinterest:active,#share-icon>a.share-pinterest:focus{color:#e60023}body{font-family:Cambria,"Times New Roman",Times,"游明朝体","Yu Mincho",YuMincho,"Hiragino Mincho ProN",serif}header{margin:0;border:0;top:0;left:0;background-color:#4f8ef6;color:#fff}header:nth-of-type(1) amp-img:nth-of-type(1){vertical-align:text-top}header .btn{color:#fff;text-decoration:none;opacity:inherit}header .btn:link,header .btn:visited{color:#fff}@media only screen and (max-width: 693px) and (orientation: portrait){.--first-view{min-height:100vh}}h1:nth-of-type(1){margin-top:0}img{max-width:100%}amp-img[layout='fill']>img[src]{object-fit:cover}amp-img[layout='responsive']>img[src]{object-fit:scale-down}hr{height:0;margin:0;padding:0;border:0;border-top:1px solid rgba(0,0,0,0.1);border-bottom:1px solid #fff}a{color:rgba(0,0,0,0.8)}a:active,a:hover,a:visited{color:rgba(0,0,0,0.8);text-decoration:none}article .--pre-bar-spacer{height:24px}article header .h1,article header .h2,article header .h3,article header .h4,article header .h5,article header .h6,article header h1,article header h2,article header h3,article header h4,article header h5,article header h6,article section .h1,article section .h2,article section .h3,article section .h4,article section .h5,article section .h6,article section h1,article section h2,article section h3,article section h4,article section h5,article section h6{letter-spacing:-0.02em;font-weight:700;margin-left:-1.8px;line-height:1.15;margin-top:40px;margin-bottom:4px}article header .h1,article header .h2,article header h1,article header h2,article section .h1,article section .h2,article section h1,article section h2{font-size:28px}article header .h2,article header h2,article section .h2,article section h2{font-weight:700;margin-top:16px;margin-bottom:6px}article header p,article section p{margin-bottom:30px}article header li,article section li{margin-bottom:15px}article header p,article header li,article section p,article section li{font-size:18px;letter-spacing:.005rem;line-height:1.45;font-weight:400}article .share--btn{padding:0 10px}article .pocket-btn{display:inline-block;height:20px;vertical-align:middle;margin-top:-2px}article amp-ad[type='adsense']{margin-bottom:1rem}article.has-ads .grid>amp-ad{padding:0}@media screen and (orientation: landscape){article.has-ads .grid>amp-ad{max-height:calc(100vh - 48px - 50px)}}@media only screen and (max-width: 693px){article.has-ads .wrapper:nth-child(4) .--pc{display:none}}@media only screen and (min-width: 694px){article.has-ads{display:-webkit-flex;display:-moz-flex;display:-ms-flex;display:-o-flex;display:flex;-webkit-flex-wrap:wrap;-moz-flex-wrap:wrap;-o-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-flex-direction:row-reverse;-moz-flex-direction:row-reverse;-o-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-justify-content:flex-start;-moz-justify-content:flex-start;-o-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start}article.has-ads .wrapper:nth-child(1),article.has-ads .wrapper:nth-child(3){width:calc(100% - 336px - 2.4rem);margin:0;padding:2.4rem;padding-right:0}article.has-ads .wrapper:nth-child(1){order:-2}article.has-ads .wrapper:nth-child(2){display:none}article.has-ads .wrapper:nth-child(4){order:-1;width:336px;height:0;padding:0;margin-top:48px}article.has-ads .wrapper:nth-child(4) .fs-small{margin-left:.7rem}article.has-ads .wrapper:nth-child(4) .--pc .fs-small{margin-top:calc(100vh - 30px - 48px - 90px)}article.has-ads .wrapper:nth-child(4) .--pc.is-amp .fs-small{margin-top:calc(100vh - 30px - 48px)}}@media only screen and (min-width: 694px) and (orientation: landscape){article.has-ads .wrapper:nth-child(4) .--pc .fs-small{margin-top:calc(100vh - 30px - 90px)}article.has-ads .wrapper:nth-child(4) .--pc.is-amp .fs-small{margin-top:calc(100vh - 30px)}}@media only screen and (min-width: 694px){article.has-ads .wrapper:nth-child(4) amp-ad[type='adsense']{margin-bottom:0}}.share-icon [class^="icon-"],.share-icon [class*=" icon-"]{color:#999;text-decoration:underline;background-color:#fff}.share-icon .icon-share-hatena{color:#008fde}.share-icon .icon-share-hatena:hover,.share-icon .icon-share-hatena:active,.share-icon .icon-share-hatena:focus{color:#008fde}.share-icon .icon-share-pocket{color:#ff004c}.share-icon .icon-share-pocket:hover,.share-icon .icon-share-pocket:active,.share-icon .icon-share-pocket:focus{color:#ff004c}@media only screen and (orientation: portrait){article header .h1,article header .h2,article header .h3,article header .h4,article header .h5,article header .h6,article header h1,article header h2,article header h3,article header h4,article header h5,article header h6,article section .h1,article section .h2,article section .h3,article section .h4,article section .h5,article section .h6,article section h1,article section h2,article section h3,article section h4,article section h5,article section h6{line-height:1.2}article header .h1,article header .h2,article header h1,article header h2,article section .h1,article section .h2,article section h1,article section h2{font-size:26px}article header p,article header li,article section p,article section li{font-size:20px;line-height:1.6}}.embed-responsive-3by1{padding-bottom:30%}.embed-responsive-3by1 .embed-responsive-item{height:auto;margin-top:-16.66666%}.text-muted{color:#777}amp-list>[overflow]{position:absolute;bottom:0}amp-list article{padding-top:.7rem}amp-list article a{text-decoration:none}amp-list article a:link,amp-list article a:visited{color:inherit}amp-list article a>p:nth-child(1){margin-left:1vw;margin-right:2vw}amp-list article a>p:nth-of-type(2){overflow:hidden}amp-list figure{position:relative;width:8em;height:8em;padding-bottom:initial;margin-right:1%}amp-list amp-img{max-width:100%}amp-list amp-img[layout]{margin-start:initial;-webkit-margin-start:initial}amp-list p{margin-left:4vw;margin-right:4vw;font-family:"Helvetica Neue",Helvetica,Arial,"游ゴシック体","Yu Gothic",YuGothic,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif}.explore{width:100vw;top:0;bottom:0;left:-100vw;z-index:3;transition:left ease-in-out .2s}.explore>div{min-height:100vh;position:relative;z-index:2;background-color:#fefefe}.explore amp-carousel{margin:0 auto;max-width:calc((100vh - 48px - 1em)*4/3);max-height:calc(100vh - 48px - 1em)}@media only screen and (min-aspect-ratio: 3 / 4) and (min-height: 768px){.explore amp-carousel{max-width:calc((100vh - 48px - 1em)*4/3/2);max-height:calc((100vh - 48px - 1em)/2)}}.explore amp-carousel amp-fit-text{position:absolute;margin:auto 0 0;max-height:calc(100%*2/3);color:#fefefe;font-weight:600;text-shadow:.5px 1.5px rgba(0,0,0,0.15);z-index:0}.explore amp-carousel amp-fit-text>div:first-of-type{background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeDE9IjAuNSIgeTE9IjAuMCIgeDI9IjAuNSIgeTI9IjEuMCI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwMDAwMCIgc3RvcC1vcGFjaXR5PSIwLjAiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMC41NCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiIC8+PC9zdmc+IA==');background-size:100%;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, rgba(0,0,0,0)),color-stop(100%, rgba(0,0,0,0.54)));background-image:-moz-linear-gradient(rgba(0,0,0,0) 0%,rgba(0,0,0,0.54) 100%);background-image:-webkit-linear-gradient(rgba(0,0,0,0) 0%,rgba(0,0,0,0.54) 100%);background-image:linear-gradient(rgba(0,0,0,0) 0%,rgba(0,0,0,0.54) 100%);backdrop-filter:blur(1px)}.explore .next{min-width:100vw;max-width:none;overflow-x:auto}.explore .next amp-list{min-height:0}.explore .next amp-list>[role='list']{position:relative;height:auto;width:auto;min-width:100vw;max-width:none;display:-webkit-flex;display:-moz-flex;display:-ms-flex;display:-o-flex;display:flex;flex-wrap:wrap;-webkit-justify-content:space-between;-moz-justify-content:space-between;-o-justify-content:space-between;-ms-justify-content:space-between;justify-content:space-between}.explore .next amp-list>[role='list']>a[role='listitem']{color:rgba(255,255,255,0.95);margin-top:1px;position:relative;z-index:0;overflow:hidden;-webkit-border-radius:2px;-moz-border-radius:2px;-o-border-radius:2px;-ms-border-radius:2px;border-radius:2px;width:calc((100vw - 2px)/3);height:calc((100vh - 2px)/3)}.explore .next amp-list>[role='list']>a[role='listitem']:active,.explore .next amp-list>[role='list']>a[role='listitem']:hover,.explore .next amp-list>[role='list']>a[role='listitem']:visited{color:rgba(255,255,255,0.95);text-decoration:none}@media only screen and (min-aspect-ratio: 3 / 4){.explore .next amp-list>[role='list']>a[role='listitem']{width:calc((100vw - 2px)/3);height:calc((100vh - 1px)/2)}}.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+6),.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+9),.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+11){margin-top:calc(-1*(100vh - 2px)/3)}@media only screen and (min-aspect-ratio: 3 / 4){.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+6),.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+9),.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+11){margin-top:calc(-1*(100vh - 1px)/2)}}.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+5),.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+11){width:calc((100vw - 2px)/3*2 + 1px);height:calc((100vh - 2px)/3*2 + 1px)}@media only screen and (min-aspect-ratio: 3 / 4){.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+5),.explore .next amp-list>[role='list']>a[role='listitem']:nth-of-type(12n+11){width:calc((100vw - 2px)/3*2 + 1px);height:100vh}}.explore .next amp-list>[role='list']>a[role='listitem']>amp-fit-text{position:absolute;bottom:0;width:100%;max-height:100%;color:#fefefe;font-family:"Helvetica Neue",Helvetica,Arial,"游ゴシック体","Yu Gothic",YuGothic,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif;font-weight:600;text-shadow:.5px 1.5px rgba(0,0,0,0.15)}.explore .next amp-list>[role='list']>a[role='listitem']>amp-fit-text>div:first-of-type{background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4gPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkIiBncmFkaWVudFVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgeDE9IjAuNSIgeTE9IjAuMCIgeDI9IjAuNSIgeTI9IjEuMCI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzAwMDAwMCIgc3RvcC1vcGFjaXR5PSIwLjAiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMC41NCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiIC8+PC9zdmc+IA==');background-size:100%;background-image:-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, rgba(0,0,0,0)),color-stop(100%, rgba(0,0,0,0.54)));background-image:-moz-linear-gradient(rgba(0,0,0,0) 0%,rgba(0,0,0,0.54) 100%);background-image:-webkit-linear-gradient(rgba(0,0,0,0) 0%,rgba(0,0,0,0.54) 100%);background-image:linear-gradient(rgba(0,0,0,0) 0%,rgba(0,0,0,0.54) 100%);backdrop-filter:blur(1px)}.explore .next amp-img{background-color:#999}.explore header figure{position:relative;width:48px;height:48px;margin-left:-1rem;padding-bottom:0}.explore amp-img{max-width:100%}.explore amp-img[layout]{margin-start:initial;-webkit-margin-start:initial}.explore amp-img,.explore amp-video,.explore amp-youtube{margin-start:initial;-webkit-margin-start:initial}.explore p{margin-left:4vw;margin-right:4vw}.footer{display:-webkit-flex;display:-moz-flex;display:-ms-flex;display:-o-flex;display:flex;-webkit-justify-content:space-around;-moz-justify-content:space-around;-o-justify-content:space-around;-ms-justify-content:space-around;justify-content:space-around}.footer a{font-size:1.3rem;color:rgba(0,0,0,0.67);text-decoration:none}.footer a:active,.footer a:focus,.footer a:hover{text-decoration:underline}#copyright{color:rgba(0,0,0,0.15);line-height:1.2em;height:1.2em;padding-bottom:.4em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:-webkit-flex;display:-moz-flex;display:-ms-flex;display:-o-flex;display:flex;-webkit-justify-content:center;-moz-justify-content:center;-o-justify-content:center;-ms-justify-content:center;justify-content:center}#copyright .rtl{direction:rtl;unicode-bidi:bidi-override;overflow:hidden;text-overflow:ellipsis}.bar-bottom{position:absolute;max-width:100vw;min-width:100vw;z-index:-1}html{background-color:#fff}.bar-bottom,.footer-ads-spacer{height:50px}@media only screen and (min-width: 694px){.bar-bottom,.footer-ads-spacer{height:90px}}.footer-chat-spacer{height:50px}@media screen{body,div,article,p{margin:0;padding:0}body{-webkit-text-size-adjust:100%;background-color:#e6e6e6;color:#1b1b1b;-webkit-font-smoothing:subpixel-antialiased;font-size:19px;line-height:30px;text-rendering:optimizeLegibility}body>article{padding-left:4vw;padding-right:4vw}body amp-img,body amp-video,body amp-youtube,body amp-iframe{margin-start:-4vw;-webkit-margin-start:-4vw}}@media only screen and (min-width: 694px){body>article{padding-left:0;padding-right:0}body amp-img,body amp-video,body amp-youtube,body amp-iframe{margin-start:0;-webkit-margin-start:0}}@media screen{body>header,body>article,body>footer{max-width:800px;margin-left:auto;margin-right:auto;text-align:start;word-wrap:break-word}body>article,body>footer{position:relative;background-color:#fbfbfb}body div,body p,body a{max-width:100%}body amp-img{width:100vw}body amp-img img{min-width:100vw}body amp-video,body amp-youtube,body amp-iframe{width:100vw}body video{width:100vw;height:auto;position:relative}}@media only screen and (min-width: 694px){body{margin:0 auto}body amp-img,body amp-video,body amp-youtube,body amp-iframe{width:initial}body img{min-width:initial}body>article,body>footer{box-shadow:0 12px 12px 3px rgba(0,0,0,0.2)}}@font-face{font-family:'siphandon';src:url("/fonts/siphandon.ttf?9zhtrx") format("truetype"),url("/fonts/siphandon.woff?9zhtrx") format("woff"),url("/fonts/siphandon.svg?9zhtrx#siphandon") format("svg");font-weight:normal;font-style:normal}.icon-explore,.icon-map,.icon-notifications,.icon-search{font-family:'siphandon';speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-explore:before{content:"🌍"}.icon-map:before{content:"🗺"}.icon-notifications:before{content:"🔔"}.icon-search:before{content:"🔍"}/*!
 ** @package IcoFont
 ** @version 1.0.1
 ** @author IcoFont https://icofont.com
 ** @copyright Copyright (c) 2015 - 2020 IcoFont
 ** @license - https://icofont.com/license/ */@font-face{font-family:"IcoFont";font-weight:normal;font-style:"Regular";src:url("/fonts/20201223.woff2") format("woff2"),url("/fonts/20201223.woff") format("woff")}[class^="icofont-"],[class*=" icofont-"]{font-family:"IcoFont";speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;white-space:nowrap;word-wrap:normal;direction:ltr;line-height:1;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}.icofont-pinterest:before{content:""}.icofont-xs{font-size:.5em}.icofont-sm{font-size:.75em}.icofont-md{font-size:1.25em}.icofont-lg{font-size:1.5em}.icofont-1x{font-size:1em}.icofont-2x{font-size:2em}.icofont-3x{font-size:3em}.icofont-4x{font-size:4em}.icofont-5x{font-size:5em}.icofont-6x{font-size:6em}.icofont-7x{font-size:7em}.icofont-8x{font-size:8em}.icofont-9x{font-size:9em}.icofont-10x{font-size:10em}.icofont-fw{text-align:center;width:1.25em}.icofont-ul{list-style-type:none;padding-left:0;margin-left:0}.icofont-ul>li{position:relative;line-height:2em}.icofont-ul>li .icofont{display:inline-block;vertical-align:middle}.icofont-border{border:solid .08em #f1f1f1;border-radius:.1em;padding:.2em .25em .15em}.icofont-pull-left{float:left}.icofont-pull-right{float:right}.icofont.icofont-pull-left{margin-right:.3em}.icofont.icofont-pull-right{margin-left:.3em}.icofont-spin{-webkit-animation:icofont-spin 2s infinite linear;animation:icofont-spin 2s infinite linear;display:inline-block}.icofont-pulse{-webkit-animation:icofont-spin 1s infinite steps(8);animation:icofont-spin 1s infinite steps(8);display:inline-block}@-webkit-keyframes icofont-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes icofont-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.icofont-rotate-90{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";-webkit-transform:rotate(90deg);transform:rotate(90deg)}.icofont-rotate-180{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";-webkit-transform:rotate(180deg);transform:rotate(180deg)}.icofont-rotate-270{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";-webkit-transform:rotate(270deg);transform:rotate(270deg)}.icofont-flip-horizontal{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.icofont-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";-webkit-transform:scale(1, -1);transform:scale(1, -1)}.icofont-flip-horizontal.icofont-flip-vertical{-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";-webkit-transform:scale(-1, -1);transform:scale(-1, -1)}:root .icofont-rotate-90,:root .icofont-rotate-180,:root .icofont-rotate-270,:root .icofont-flip-horizontal,:root .icofont-flip-vertical{-webkit-filter:none;filter:none;display:inline-block}.icofont-inverse{color:#fff}.sr-only{border:0;clip:rect(0, 0, 0, 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}@font-face{font-family:'style';src:url("/fonts/style.ttf?225wom") format("truetype"),url("/fonts/style.woff?225wom") format("woff"),url("/fonts/style.svg?225wom#style") format("svg");font-weight:normal;font-style:normal}.icon-share-google,.icon-feedly,.icon-share-pocket,.icon-share-line,.icon-share-hatena,.icon-share-facebook,.icon-share-twitter,.icon-notifications,.icon-search{font-family:'style';speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-share-google:before{content:"🔗"}.icon-feedly:before{content:"🔥"}.icon-share-pocket:before{content:"📑"}.icon-share-line:before{content:"💬"}.icon-share-hatena:before{content:"❔"}.icon-share-facebook:before{content:"🗣"}.icon-share-twitter:before{content:"🐦"}.icon-notifications:before{content:"🔔"}.icon-search:before{content:"🔍"}


article[data-src='https://michilu.com/blog/posts/100/']{display:none}
</style>
<style>

</style>
<script type='application/ld+json'>{"publisher": {"logo": {"url": "https://michilu.com/img/apple-touch-icon-180x.png", "width": 60, "@type": "ImageObject", "height": 60}, "@type": "Organization", "name": "Site Author:"}, "author": {"@type": "Person", "name": "Site Author:"}, "headline": "[Django]: Django\u548c\u8a33\u30c9\u30ad\u30e5\u30e1\u30f3\u30c8 sync to r5754&amp;mdash;", "image": {"url": "https://michilu.com/img/apple-touch-icon-180x.png", "width": 700, "@type": "ImageObject", "height": 470}, "datePublished": "2007-08-07T00:10:09+09:00", "@type": "BlogPosting", "mainEntityOfPage": "https://michilu.com/blog/posts/100/", "@context": "http://schema.org", "dateModified": "2007-08-07T00:10:09+09:00"}</script>

<meta content='🌝ﾂｷﾖﾐﾁﾙ' name='apple-mobile-web-app-title'>


<meta content='ツキヨミチル' itemprop='name'>
<meta content='ツキヨミチル' property='og:site_name'>

<meta content='article' property='og:type'>
<meta content='[Django]: Django和訳ドキュメント sync to r5754' property='og:title'>

<meta content='https://michilu.com/blog/posts/100/' property='og:url'>
<meta content="[Django]: Django和訳ドキュメント sync to r5754" property='og:description'>

<meta content='https://michilu.com/img/apple-touch-icon-200x.png' property='og:image'>



<link href='/manifest.json' rel='manifest'>

<link href='/img/apple-touch-icon-180x.png' rel='apple-touch-icon' sizes='180x180'>
<link href='/img/apple-touch-icon-180x.png' rel='apple-touch-icon-precomposed'>
<link href='/img/apple-touch-icon-180x.png' rel='shortcut icon'>
<link href='/img/apple-touch-icon-192x.png' rel='icon' sizes='192x192'>
</head>
<body>
<amp-analytics type='googleanalytics'>
<script type='application/json'>{"requests": {"scrollEvent": "${host}/debug/collect?${basePrefix}&t=event\n&ec=${eventCategory}&ea=${eventAction}&el=${eventLabel}&ev=${eventValue}\n&ni=${ni}\n${baseSuffix}", "scrollTiming": "${host}/debug/collect?${basePrefix}&t=timing\n&utc=${timingCategory}&utv=${timingVar}&utt=${timingValue}&utl=${timingLabel}\n${baseSuffix}"}, "vars": {"account": null}, "triggers": {"trackPageview": {"on": "visible", "request": "pageview"}, "scrollPercentage": {"on": "scroll", "request": "scrollEvent", "vars": {"ni": true, "account": null, "eventLabel": "${verticalScrollBoundary}%", "eventValue": 1, "eventCategory": "Scroll Depth", "eventAction": "Percentage"}, "scrollSpec": {"verticalBoundaries": [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]}}, "scrollPixel": {"on": "scroll", "request": "scrollEvent", "vars": {"ni": true, "account": null, "eventLabel": "${scrollTop}", "eventValue": 1, "eventCategory": "Scroll Depth", "eventAction": "Pixel Depth"}, "scrollSpec": {"verticalBoundaries": [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]}}, "scrollTiming": {"on": "scroll", "request": "scrollTiming", "vars": {"timingCategory": "Scroll Depth", "timingValue": "${totalEngagedTime}000", "timingLabel": "${verticalScrollBoundary}%", "timingVar": "Percentage", "account": null}, "scrollSpec": {"verticalBoundaries": [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]}}}}</script>
</amp-analytics>
<header class='grid' id='navbar-top'>
<div class='column--heavy grid' id='share-icon'>
<a class='btn btn--link visible-xs-inline-block' href='/'>
<span aria-hidden='true' class='icon-map'></span>
</a>
<a class='btn btn--link share-line visible-xs-inline-block' href='https://line.me/R/msg/text/?[Django]: Django和訳ドキュメント sync to r5754 https://michilu.com/blog/posts/100/' target='_blank' title='LINEで送る'>
<span aria-hidden='true' class='icon-share-line'></span>
</a>
<a class='btn btn--link share-hatena' href='http://b.hatena.ne.jp/add?mode=confirm&amp;url=https://michilu.com/blog/posts/100/' rel='noopener' target='_blank' title='はてブに追加する'>
<span aria-hidden='true' class='icon-share-hatena'></span>
</a>
<a class='btn btn--link share-twitter' href='https://twitter.com/share?u=https://michilu.com/blog/posts/100/&amp;text=[Django]: Django和訳ドキュメント sync to r5754' rel='noopener' target='_blank' title='Twitterにツイートする'>
<span aria-hidden='true' class='icon-share-twitter'></span>
</a>
<a class='btn btn--link share-facebook' href='https://www.facebook.com/share.php?u=https://michilu.com/blog/posts/100/' rel='noopener' target='_blank' title='Facebookでシェアする'>
<span aria-hidden='true' class='icon-share-facebook'></span>
</a>
<a class='btn btn--link share-pinterest' href='https://www.pinterest.com/pin/create/button/?url=https://michilu.com/blog/posts/100/' rel='noopener' target='_blank' title='Pinterestに保存する'>
<span aria-hidden='true' class='icofont-pinterest'></span>
</a>
</div>
</header>

<article class=''>

<div class='wrapper wrapper--small'>

<div class='--pre-bar-spacer grid'>
<div class='btn btn--link disabled'>&#8203;</div>
</div>
<section>

<h1>[Django]: Django和訳ドキュメント sync to r5754</h1>


<p><a class="reference external" href="http://michilu.com/django/doc-ja/index/">Django オンラインドキュメント和訳</a> 更新しました。 Revision 5754 (2007/07/25). 「オブジェクトの保存時に何が起きるのか」「生データの保存」「カスタムのフィールド型」「unittest を書く」「regroup」についての記述が更新されています。</p>
<ul class="simple">
<li>データベース API リファレンス - オブジェクトの生成 - <a class="reference external" href="http://michilu.com/django/doc-ja/db-api/#what-happens-when-you-save">オブジェクトの保存時に何が起きるのか</a> , <a class="reference external" href="http://michilu.com/django/doc-ja/db-api/#raw-saves">生データの保存</a></li>
<li>データベース API リファレンス - ショートカット用の関数 - <a class="reference external" href="http://michilu.com/django/doc-ja/db-api/#get-object-or-404">get_object_or_404()</a></li>
<li>モデル API リファレンス - フィールド - <a class="reference external" href="http://michilu.com/django/doc-ja/model-api/#custom-field-types">カスタムのフィールド型</a></li>
<li>Djangoアプリケーションのテスト - テストを書く - <a class="reference external" href="http://michilu.com/django/doc-ja/testing/#writing-unittests">unittest を書く</a></li>
<li>テンプレート作者のための Django テンプレート言語ガイド - 組み込みタグリファレンス - <a class="reference external" href="http://michilu.com/django/doc-ja/templates/#regroup">regroup</a></li>
</ul>
<p>以下、 diff -r 5692:5754 の主な変更分です。</p>
<div class="section" id="id4">
<h1><a class="reference external" href="http://michilu.com/django/doc-ja/db-api/#what-happens-when-you-save">オブジェクトの保存時に何が起きるのか</a></h1>
<p>Django は以下の段階を踏んでオブジェクトを保存します:</p>
<blockquote>
<ol class="arabic">
<li><p class="first"><strong>``pre_save`` シグナルの発行</strong> シグナルの発行によって，何らかのオブ
ジェクトを保存しようとしていることを通知します．リスナ (listener) を
用意して登録しておけ， <tt class="docutils literal">pre_save</tt> シグナルが発行された時に実行でき
ます (シグナルのドキュメントはまだありません)．</p>
</li>
<li><p class="first"><strong>データの前処理</strong> オブジェクトの各フィールドについて，保存時に自動
的に実行する必要があるデータ修飾処理がないか調べ，あれば実行します．</p>
<p>ほとんどのフィールドは前処理を <em>伴いません</em> ．フィールドのデータは
そのまま保存されます．前処理が行われるのは，特殊な挙動を示すフィー
ルドだけです．例えば， <tt class="docutils literal">auto_now=True</tt> に設定された <tt class="docutils literal">DateField</tt>
の場合，前処理の段階で，フィールドの内容が現在の日付になるようデータ
を置き換えます (現時点では，「特殊な」挙動を示すフィールドのリストを
全て列挙したドキュメントはありません)．</p>
</li>
<li><p class="first"><strong>データベース保存用のデータ準備処理</strong> 各フィールドについて，フィー
ルドの現在の値を元にデータベースに保存できる型のデータを生成します．</p>
<p>ほとんどのフィールドはデータ準備処理を <em>伴いません</em> ．整数や文字列は
Python オブジェクトとして「いつでもデータベースへの書き込みに使える」
形式になっています．ただ，より複雑なデータ型の場合，なにがしかの修飾
が必要なことがあります．</p>
<p>例えば， <tt class="docutils literal">DateField</tt> は，データの保存に Python の <tt class="docutils literal">datetime</tt> 型
を使います．データベースは <tt class="docutils literal">datetime</tt> オブジェクトを保存しないので，
データベースに保存するには，フィールドの値を ISO 準拠の日付文字列に
変換せねばなりません．</p>
</li>
<li><p class="first"><strong>データベースへの保存</strong> 前処理と準備処理を経たデータが SQL 文に組み
込まれ，データベースに挿入されます．</p>
</li>
<li><p class="first"><strong>``post_save`` シグナルの発行</strong> <tt class="docutils literal">pre_save</tt> シグナルと同じく，オブ
ジェクトが成功理に保存されたことを通知するために <tt class="docutils literal">post_save</tt> シグ
ナルが発行されます (シグナルのドキュメントはまだありません)．</p>
</li>
</ol>
</blockquote>
</div>
<div class="section" id="id5">
<h1><a class="reference external" href="http://michilu.com/django/doc-ja/db-api/#raw-saves">生データの保存</a></h1>
<p><strong>開発版の Django で新たに追加された機能です</strong></p>
<p>前処理段階 (全節の項目 #2) は便利ですが，フィールドに保存されているデータを
勝手に修飾してしまいます．指定したデータをそのまま保存させたい場合には，こ
の仕様が問題を引き起こすかもしれません．</p>
<p>例えば，テストを実行するために何らかのテスト条件を構築するなら，テスト条件
に再現性をもたせる必要があるでしょう．前処理が実行されると，テスト条件に使
うデータが修飾されて，テストの実行ごとに違ったテスト条件をもたらしてしまう
かも知れません．</p>
<p>こうした問題を防ぐには，オブジェクトの保存時に前処理を抑制する必要がありま
す．前処理を抑制するには， <tt class="docutils literal">save()</tt> メソッドに <tt class="docutils literal">raw=True</tt> 引数を指定し
て， <strong>生データを保存</strong> します:</p>
<pre class="literal-block">
b4.save(raw=True)  # オブジェクトを保存しますが，前処理は行いません
</pre>
<p>生データの保存を行うと，保存時に実行されるたいていの前処理を行いません．
ただし， (<tt class="docutils literal">pre_save</tt> シグナルの発行，データの準備処理，データベースへの挿
入処理， <tt class="docutils literal">post_save</tt> シグナルの発行といった) 前処理以外の処理は通常通り実
行されます．</p>
<div class="admonition admonition-">
<p class="first admonition-title">「生データ保存」の使いどころ</p>
<p class="last">ざっくり言えば，生データ保存はまず使う必要はないでしょう．フィールドの前
処理抑制は，再現性のあるテスト環境の構築のように，よほど変わった状況でな
いかぎり使うべきでない極端な手段なのです．</p>
</div>
</div>
<div class="section" id="id6">
<h1><a class="reference external" href="http://michilu.com/django/doc-ja/db-api/#get-object-or-404">get_object_or_404()</a></h1>
<p>カスタムマネジャにカスタムメソッド追加して使いたい場合は，
<tt class="docutils literal">get_object_or_404()</tt> にクエリセットを渡します:</p>
<pre class="literal-block">
# カスタムマネジャの 'published' メソッドが返すクエリセットを使って
# 主キーの値が 5 のオブジェクトを検索する
e = get_object_or_404(Entry.objects.published(), pk=5)
</pre>
</div>
<div class="section" id="id7">
<h1><a class="reference external" href="http://michilu.com/django/doc-ja/model-api/#custom-field-types">カスタムのフィールド型</a></h1>
<p><strong>開発版の Django で新たに追加された機能です</strong></p>
<p>Django の組み込みフィールド型は，データベースのカラムとして利用できる全ての
データ型をサポートしているわけではなく， <tt class="docutils literal">VARCHAR</tt> や <tt class="docutils literal">INTEGER</tt> のよう
な一般的な型しかサポートしていません．幾何多角形 (geographic polygon) 型や，
<a class="reference external" href="http://www.postgresql.org/docs/8.2/interactive/sql-createtype.html">PostgreSQL カスタム型</a> のようなユーザ定義型といった特異な型を扱うには，
<tt class="docutils literal">Field</tt> 型のサブクラスを定義する必要があります．</p>
<div class="admonition admonition-experimental-territory">
<p class="first admonition-title">Experimental territory</p>
<p>この分野は， Django の中でも伝統的にドキュメント化されて来なかった部分で
すが，これからは少しづつドキュメントを増やしていく予定です．というわけで，
当面は薄い内容ですがご容赦くださいね．</p>
<p class="last">最先端の世界に住むのが好きで，不安定でドキュメント化されていない API を使
うリスクを気にしないのなら， <tt class="docutils literal">django/db/models/fields/__init__.py</tt> の
コアの <tt class="docutils literal">Field</tt> クラスのコードを読むとよいでしょう -- ただし，中身がごっ
そり変わっていても，そんなの聞いてないよなんて言わないでくださいね．</p>
</div>
<p>カスタムのフィールド型を定義するには， <tt class="docutils literal">django.db.models.Field</tt> をサブク
ラス化します．サブクラスで実装せねばならないメソッドの一部を以下に示します:</p>
<div class="section" id="db-type">
<h2><tt class="docutils literal">db_type()</tt></h2>
<p><tt class="docutils literal">DATABASE_ENGINE</tt> 設定に指定されているデータベースで，フィールドのデータ
を保存するために使うカラム型を返します．</p>
<p>例えば， PostgreSQL 固有のカスタム型 <tt class="docutils literal">mytype</tt> を作成したとしましょう．
Django からこの型を使うには，以下のように <tt class="docutils literal">Field</tt> をサブクラス化して，
<tt class="docutils literal">db_type()</tt> メソッドを実装します</p>
<pre class="code python literal-block">
from django.db import models

class MytypeField(models.Field):
    def db_type(self):
        return 'mytype'
</pre>
<p><tt class="docutils literal">MytypeField</tt> を定義したら，他のフィールド型と同じようにモデルで利用でき
ます</p>
<pre class="code python literal-block">
class Person(models.Model):
    name = models.CharField(maxlength=80)
    gender = models.CharField(maxlength=1)
    something_else = MytypeField()
</pre>
<p>データベースに依存しないアプリケーションを構築したいなら，データベースごと
のカラム型の違いに注意しておかねばなりません．例えば， PostgreSQL では日付
や時間に関するカラム型は <tt class="docutils literal">timestamp</tt> 型ですが， MySQL では <tt class="docutils literal">datetime</tt>
型です．この違いを <tt class="docutils literal">db_type()</tt> メソッドの中で吸収するには，Djangoの
<tt class="docutils literal">settings</tt> モジュールを import しておいて，以下のように
<tt class="docutils literal">DATABASE_ENGINE</tt> 設定をチェックします</p>
<pre class="code python literal-block">
class MyDateField(models.Field):
    def db_type(self):
        from django.conf import settings
        if settings.DATABASE_ENGINE == 'mysql':
            return 'datetime'
        else:
            return 'timestamp'
</pre>
<p><tt class="docutils literal">db_type()</tt> メソッドは，Django がアプリケーションのテーブルを生成するため
の <tt class="docutils literal">CREATE TABLE`</tt> 文を構築する瞬間，すなわち最初にテーブルを生成する瞬
間しか呼び出されません．それ以外の場合に呼び出されることはないので，上記の
<tt class="docutils literal">DATABASE_ENGINE</tt> をチェックする例のような多少ややこしいコードを書いても
さして問題ではありません．</p>
<p>カラムのデータ型にはパラメタをとるものがあります．例えば <tt class="docutils literal">CHAR(25)</tt> は，
<tt class="docutils literal">25</tt> がカラムの最大長を表しています．こうした場合には， <tt class="docutils literal">db_type()</tt> メ
ソッド内でハードコードしておくよりも，モデル内でパラメタを指定して使えるよ
うになっていた方が柔軟性を高められます．例えば，以下に示すような
<tt class="docutils literal">CharMaxlength25Field</tt> はあまり便利ではありません</p>
<pre class="code python literal-block">
# パラメタをハードコードしているおバカな例
class CharMaxlength25Field(models.Field):
    def db_type(self):
        return 'char(25)'

# モデル内での使い方
class MyModel(models.Model):
    # ...
    my_field = CharMaxlength25Field()
</pre>
<p>実行時，すなわちフィールドクラスをインスタンス化する時にパラメタを指定でき
た方がよいでしょう．パラメタを指定できるようにするには，以下のように
<tt class="docutils literal">__init__()</tt> を実装します</p>
<pre class="code python literal-block">
# より柔軟性のある例
class BetterCharField(models.Field):
    def __init__(self, maxlength, *args, **kwargs):
        self.maxlength = maxlength
        super(BetterCharField, self).__init__(*args, **kwargs)

    def db_type(self):
        return 'char(%s)' % self.maxlength

# モデル内での使い方
class MyModel(models.Model):
    # ...
    my_field = BetterCharField(25)
</pre>
<p>フィールドクラスの <tt class="docutils literal">__init__()</tt> を実装する場合は，必ず親クラスの
<tt class="docutils literal">Field.__init__()</tt> すなわち親クラスの <tt class="docutils literal">__init__()</tt> メソッドを呼び出して
ください．</p>
</div>
</div>
<div class="section" id="id8">
<h1><a class="reference external" href="http://michilu.com/django/doc-ja/testing/#writing-unittests">unittest を書く</a></h1>
<p><a class="reference external" href="http://michilu.com/django/doc-ja/testing/#running-tests">テストを実行する</a> と，テストユーティリティはデフォルトの動作として，
<tt class="docutils literal">models.py</tt> と <tt class="docutils literal">tests.py</tt> に入っている全てのテストケース (つまり
<tt class="docutils literal">unittest.TestCase</tt> のサブクラス) を捜し出し，そこからテストスイートを自
動的に構築して，スイートを実行します．</p>
<p><strong>開発バージョンの Django で登場した機能</strong></p>
<p>ただし， <tt class="docutils literal">models.py</tt> や <tt class="docutils literal">tests.py</tt> で <tt class="docutils literal">suite()</tt> メソッドを定義してい
る場合，モジュールのテストスイートの構築は <tt class="docutils literal">suite()</tt> メソッドを使って行い
ます．この仕様は，ユニットテストにおいて
<a class="reference external" href="http://python.jp/doc/release/lib/organizing-tests.html">推奨されているテストスイートの構築方法</a> に従っています．複雑なテストスイー
トの構築方法についての詳細は Python のドキュメントを参照してください．</p>
<p><tt class="docutils literal">unittest</tt> の詳細は <a class="reference external" href="http://python.jp/doc/release/lib/module-unittest.html">標準ライブラリドキュメントの unittest の項</a> を参照
してください．</p>
<!-- unittest: http://docs.python.org/lib/module-unittest.html -->
<dl class="docutils">
<dt><tt class="docutils literal">assertContains(response, text, count=None, status_code=200)</tt></dt>
<dd>ページの取得が行われ，指定の HTTP 状態コードが生成され，レスポンス
のコンテンツ内に <tt class="docutils literal">text</tt> が入っているかどうか調べるアサーションです．
<tt class="docutils literal">count</tt> を指定すると， <tt class="docutils literal">text</tt> は正確に <tt class="docutils literal">count</tt> 回出現せねばなりま
せん．</dd>
</dl>
<p>慣習的に，テストランナは <tt class="docutils literal">run_tests</tt> と呼ぶことになっていますが，実際には
どんな名前にしてもかまいません．ただし，テストランナは以下のように Django
テストランナと同じ引数をとらねばなりません:</p>
<dl class="docutils">
<dt><tt class="docutils literal">run_tests(module_list, verbosity=1, interactive=True, <span class="pre">extra_tests=[])</span></tt></dt>
<dd><p class="first"><tt class="docutils literal">module_list</tt> はテスト対象のモデルが入った Python モジュールのリストで，
<tt class="docutils literal">django.db.models.get_apps()</tt> が返すのと同じフォーマットです．
テストランナはこのリストに挙げたモジュールからテストを捜し出さねばなりま
せん．</p>
<p><tt class="docutils literal">verbosity</tt> には，コンソールに出力される通知情報やデバッグ情報の量を指
定します．  <tt class="docutils literal">0</tt> にすると何も出力しません． <tt class="docutils literal">1</tt> は通常の出力， <tt class="docutils literal">2</tt>
は多めの出力です．</p>
<p><strong>開発バージョンの Django で新たに追加された機能</strong>
<tt class="docutils literal">interactive</tt> を <tt class="docutils literal">True</tt> にすると，テストスイートの実行時にテストラン
ナがユーザに指示を尋ねられるようにします．例えば，テストデータベースを削
除してよいか尋ねるといった使い方です． <tt class="docutils literal">interactive</tt> が <tt class="docutils literal">False</tt> の場
合，テストスイートは手動操作の介在なく実行できねばなりません．</p>
<p><tt class="docutils literal">extra_tests</tt> には，このテストランナに追加で実行させたい <tt class="docutils literal">TestCase</tt>
インスタンスを指定します． <tt class="docutils literal">extra_tests</tt> を指定すると， <tt class="docutils literal">module_list</tt>
から発見したテストに加えて，指定したテストを実行します．</p>
<p class="last">このメソッドは失敗したテストの数を返さねばなりません．</p>
</dd>
</dl>
</div>
<div class="section" id="id13">
<h1><a class="reference external" href="http://michilu.com/django/doc-ja/templates/#regroup">regroup</a></h1>
<p><tt class="docutils literal">{% regroup %}</tt> は入力をソートしないので注意してください! 上の例では，
リスト <tt class="docutils literal">people</tt> はあらかじめ <tt class="docutils literal">gender</tt> でソート済みという前提に立ってい
ます． <tt class="docutils literal">people</tt> が <tt class="docutils literal">gender</tt> の順に並んで <em>いない</em> 場合，再グループは何
も考えずに一つの性別のグループを複数つくってしまいます．例えば， <tt class="docutils literal">people</tt>
が以下のように (<tt class="docutils literal">'Male'</tt> がリスト内でまとまっていない状態に) なっていたと
しましょう</p>
<pre class="code python literal-block">
people = [
    {'first_name': 'Bill', 'last_name': 'Clinton', 'gender': 'Male'},
    {'first_name': 'Pat', 'last_name': 'Smith', 'gender': 'Unknown'},
    {'first_name': 'Margaret', 'last_name': 'Thatcher', 'gender': 'Female'},
    {'first_name': 'George', 'last_name': 'Bush', 'gender': 'Male'},
    {'first_name': 'Condoleezza', 'last_name': 'Rice', 'gender': 'Female'},
]
</pre>
<p>この <tt class="docutils literal">people</tt> を入力に使うと，上の <tt class="docutils literal">{% regroup %}</tt> のテンプレートコード
例は以下のような出力を生成します:</p>
<pre class="literal-block">
* Male:
    * Bill Clinton
* Unknown:
    * Pat Smith
* Female:
    * Margaret Thatcher
* Male:
    * George Bush
* Female:
    * Condoleezza Rice
</pre>
<p>こうした落し穴を解決したければ，ビューコード内であらかじめデータを表示した
い順番に並べておくのが最も簡単でしょう．</p>
<p>データが辞書の列の場合には，もう一つの解決策として，テンプレートの中で
<tt class="docutils literal">dictsort</tt> フィルタを使ってデータを並べ変えられます</p>
<pre class="code django literal-block">
{% regroup people|dictsort:&quot;gender&quot; by gender as gender_list %}
</pre>
<hr class="docutils" />
<p><a class="reference external" href="http://MiCHiLU.com/blog/posts/100/">http://MiCHiLU.com/blog/posts/100/</a></p>
<blockquote>
<ul class="simple">
<li>Added at         Tue, 7 Aug 2007 00:10:09 +0900</li>
<li>Last modified at Tue, 7 Aug 2007 00:10:09 +0900</li>
</ul>
</blockquote>
<p>This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 2.1 Japan License.
<a class="reference external" href="http://creativecommons.org/licenses/by-nc-sa/2.1/jp/">http://creativecommons.org/licenses/by-nc-sa/2.1/jp/</a></p>
</div>

<p>
author:




<br>
Posted on
<time datetime='2007-08-07T00:10:09+09:00'>2007-8-7</time>


<br>
Updated on
<time datetime='2007-08-07T00:10:09+09:00'>2007-8-7</time>

</p>

</section>
</div>

</article>

<script>
  (function() {
    var element, i, len, ref, selector;
  
    if (window.matchMedia('(max-width: 629px)').matches) {
      selector = '.\\-\\-pc';
    } else {
      selector = '.\\-\\-sp';
    }
  
    ref = document.querySelectorAll(selector);
    for (i = 0, len = ref.length; i < len; i++) {
      element = ref[i];
      element.parentNode.removeChild(element);
    }
  
  }).call(this);
</script>



<div class='explore'>
<div>
<header class='grid'>
<div class='grid'>
<a class='btn btn--link visible-xs-inline-block disabled'>
<figure>
<amp-img alt='Author Avatar' class='img-circle' layout='fill' src='/img/author_avatar.jpg'></amp-img>
</figure>
</a>
<a class='btn btn--link visible-xs-inline-block disabled'>&#8203;</a>
<a class='btn btn--link' href='https://feedly.com/i/subscription/feed/https://michilu.com/rss.xml' target='_blank'>
<span class='icon-feedly'></span>
</a>
<a class='btn btn--link visible-xs-inline-block disabled'>&#8203;</a>
<a class='btn btn--link visible-xs-inline-block disabled'>&#8203;</a>
</div>
</header>

<amp-carousel autoplay delay='3500' height='320' layout='responsive' loop type='slides' width='320'>
<div class='slide'>
<amp-img layout='fill' src='https://picsum.photos/2048.webp?random'></amp-img>
<amp-fit-text class='caption' layout='fill' min-font-size='15'></amp-fit-text>
</div>
</amp-carousel>
<div class='next'>
<amp-list height='1' layout='responsive' src='/amp-list/newer.json?RANDOM' width='320'>
<template type='amp-mustache'>
<a href='{{root_relative_url}}'>
<amp-fit-text height='152' layout='responsive' width='320'>{{title}}</amp-fit-text>
{{#image}}
<amp-img layout='fill' src='{{.}}'></amp-img>
{{/image}}
{{^image}}
<amp-img layout='fill' src='https://picsum.photos/2048.webp?{{root_relative_url}}'></amp-img>
{{/image}}
</a>
</template>
</amp-list>
</div>
</div>
</div>
<footer class='ta-center fs-small text-muted' id='copyright'>
&copy;<span>2001-</span><span id='this-year'>2020</span>&nbsp;
ツキヨミチル
</footer>
</body>
</html>
<script async src='/js/script.js?d1c2727beb38af70907976dee9ffe7e4'></script>